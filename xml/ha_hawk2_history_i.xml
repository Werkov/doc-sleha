<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1
[
  <!ENTITY % entities SYSTEM "entity-decl.ent">
    %entities;
]>
<!-- Converted by suse-upgrade version 1.1 -->
<sect1 xmlns="http://docbook.org/ns/docbook" 
 xmlns:xi="http://www.w3.org/2001/XInclude" 
 xmlns:xlink="http://www.w3.org/1999/xlink" 
 version="5.0" xml:id="sec.conf.hawk2.history">

 <title>Viewing the Cluster History</title>

    <info>
   <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
    <dm:maintainer/>
    <dm:status>editing</dm:status>
    <dm:deadline/>
    <dm:priority/>
    <dm:translation>yes</dm:translation>
    <dm:languages/>
    <dm:release/>
    <dm:repository/>
   </dm:docmanager>
    </info>

  <para>
   &hawk2; provides the following possibilities to view past events on the
   cluster (on different levels and in varying detail):
  </para>

 <itemizedlist>
  <listitem>
   <para>
    <xref linkend="sec.conf.hawk2.history.recent"/>
   </para>
  </listitem>
  <listitem>
   <para>
    <xref linkend="sec.conf.hawk2.history.explorer"/>
   </para>
  </listitem>
  <listitem>
   <para>
    <xref linkend="sec.conf.hawk2.history.transitions"/>
   </para>
  </listitem>
 </itemizedlist>

 <sect2 xml:id="sec.conf.hawk2.history.recent">
  <title>Viewing Recent Events of Nodes or Resources</title>
  <procedure>
   <step>
    <para>Log in to &hawk2;:</para>
    <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para> In the left navigation bar, select <guimenu>Status</guimenu>.
    It shows a list of <guimenu>Resources</guimenu> and <guimenu>Nodes</guimenu>.
    </para>
   </step>
   <step>
    <para>To view recent events of a resource:</para>
    <substeps>
     <step>
      <para>Click <guimenu>Resources</guimenu> and select the respective resource.</para>
     </step>
     <step><para>In the <guimenu>Operations</guimenu> column for the resource,
      click the arrow down button and select <guimenu>Recent Events</guimenu>.
     </para>
      <para>&hawk2; open a new window and displays a table view of the latest
       events.</para>
     </step>
    </substeps>
   </step>
   <step>
    <para>To view recent events of a node:</para>
    <substeps>
     <step>
      <para>Click <guimenu>Nodes</guimenu> and select the respective node.</para>
     </step>
     <step>
      <para>In the <guimenu>Operations</guimenu> column for the node,
      select <guimenu>Events</guimenu>.
       <remark>taroth 2016-10-28: why does the label differ for resources/nodes? 
        TODO: file bug report</remark>
     </para>
      <para>&hawk2; opens a new window and displays a table view of the latest
       events.</para>
     </step>
    </substeps>
   </step>
  </procedure>
 </sect2>
 <sect2 xml:id="sec.conf.hawk2.history.explorer">
  <title>Using the History Explorer for Cluster Reports</title>
  <para>
   The <guimenu>History Explorer</guimenu> allows you to create detailed
   cluster reports and view transition information. It provides the following
   options:</para>
  <variablelist>
   <varlistentry>
    <term><guimenu>Generate</guimenu></term>
    <listitem>
     <para>Create a cluster report for a certain time. &hawk2; calls
      the <command>crm report</command> command to generate the report.</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Upload</guimenu></term>
    <listitem>
     <para>Allows you to upload <literal>crm report</literal> archives that
      have either been created with the &crmshell; directly or even on a different
      cluster. For details, see FIXME.</para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>After report have been generated or uploaded, they are shown below
   <guimenu>Reports</guimenu>. From the list of reports, you
  can show a report's details, download or delete the report.</para>

  <para>If you choose <guimenu>Show</guimenu>, &hawk2; displays the following
  details:</para>
  <itemizedlist xml:id="il.hawk2.history.report.details">
   <title>Report Details in History Explorer</title>
   <listitem>
    <para>Name of the report.</para>
   </listitem>
   <listitem>
    <para>Start time of the report.</para>
   </listitem>
   <listitem>
    <para>End time of the report.</para>
   </listitem>
   <listitem>
    <para>Number of transitions plus time line of all transitions in the cluster
     that are covered by the report. To learn how to view more details for a
     transition, see <xref linkend="sec.conf.hawk2.history.transitions"/>.</para>
   </listitem>
   <listitem>
    <para>Node events covered by the report.</para>
   </listitem>
   <listitem>
    <para>Resource events covered by the report.</para>
   </listitem>
  </itemizedlist>

  <procedure xml:id="pro.hawk2.history.report">
   <title>Generating or Uploading a Cluster Report</title>
   <step>
    <para>Log in to &hawk2;:</para>
    <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para> In the left navigation bar, select <guimenu>History</guimenu>. </para>
    <para>The <guimenu>History Explorer</guimenu> screen opens in the
     <guimenu>Generate</guimenu> view. By default, the suggested time frame for
     a report is the last hour.</para>
   </step>
   <step>
    <para>To create a cluster report:</para>
    <substeps>
     <step>
      <para>To immediately start a report, click <guimenu>Generate</guimenu>.
      </para>
     </step>
     <step>
      <para>To modify the time frame for the report, click anywhere on the
       suggested time frame and select another option from the drop-down list
       that opens. It also allows you to enter a <guimenu>Custom</guimenu> start
       date, end date and hour, respectively. To start the report, click
        <guimenu>Generate</guimenu>. </para>
     </step>
    </substeps>
    <para>After the report has finished, it is shown below
     <guimenu>Reports</guimenu>.</para>
   </step>
   <step>
    <para>To upload a cluster report, the <command>crm report</command> archive
    must be located on a file system that you can access with &hawk2;. Proceed as
    follows:</para>
    <substeps>
     <step>
      <para>Switch to the <guimenu>Upload</guimenu> tab.
       </para>
     </step>
     <step>
      <para><guimenu>Browse</guimenu> for the cluster report archive and click
       <guimenu>Upload</guimenu>.
      </para>
     </step>
    </substeps>
    <para>After the report is uploaded, it is shown below
     <guimenu>Reports</guimenu>.
    </para>
   </step>
   <step>
    <para>To download or delete a report, click the respective icon in the
      <guimenu>Operations</guimenu> column next to it. </para>
   </step>
   <step>
    <para>To view <xref linkend="il.hawk2.history.report.details"
      xrefstyle="select:title"/>, click the report's name or select
      <guimenu>Show</guimenu> from the <guimenu>Operations</guimenu> column.
    </para>
   </step>
   <step>
    <para>Return to the list of reports by clicking the
      <guimenu>Reports</guimenu> button.</para>
   </step>
  </procedure>
 <!-- <figure>
   <title>&hawk2;&mdash;History Report</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="hawk-history-report.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="hawk-history-report.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>-->
 </sect2>
 <sect2 xml:id="sec.conf.hawk2.history.transitions">
  <title>Viewing Transition Details in the History Explorer</title>
  <para>For each transition, the cluster saves a copy of the state which it
   provides as input to the policy engine (PE). The path to this archive is logged.
   All <filename>pe-input*</filename> files are generated on the Designated
   Coordinator (DC). As the DC can change in a cluster, there may be
   <filename>pe-input*</filename> files from several nodes.
   Any <filename>pe-input*</filename> files show what the PE
   <emphasis>planned</emphasis> to do.</para>
  <para>In &hawk2;, you can display the name of
   each <filename>pe-input*</filename> file plus the time and node on which it was
   created. The <guimenu>History Explorer</guimenu> can visualize the
   following details taken from the respective <filename>pe-input*</filename>
   file:</para>

  <variablelist xml:id="vl.hawk2.history.transition.details">
   <title>Transition Details in the History Explorer</title>
   <varlistentry>
    <term><guimenu>Details</guimenu>
   </term>
    <listitem>
     <para>Shows snippets of logging data that belongs to the transition.
      Displays the output of the following command:
     </para>
     <screen>crm history transition <replaceable>peinput</replaceable></screen>
     <para>(including the resource agents' log messages)</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Configuration</guimenu>
    </term>
    <listitem>
     <para>Shows the cluster configuration at the time that the
      <filename>pe-input*</filename> file was created.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Diff</guimenu>
    </term>
    <listitem>
     <para>Shows the differences of configuration and status between the selected
      <filename>pe-input*</filename> file and the following one.</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Log</guimenu></term>
    <listitem>
     <para>Shows snippets of logging data that belongs to the transition.
     Displays the output of the following command:</para>
     <screen>crm history transition log <replaceable>peinput</replaceable></screen>
     <para>This includes details from the <systemitem>pengine</systemitem>,
       <systemitem>crmd</systemitem>, and <systemitem>lrmd</systemitem>.</para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Graph</guimenu>
   </term>
    <listitem>
     <para> A graphical representation of the transition. If you choose
      to show the <guimenu>Graph</guimenu>, the PE is reinvoked (using the
       <filename>pe-input*</filename> files), and generates a graphical
      visualization of the transition.</para>
     </listitem>
   </varlistentry>
  </variablelist>
  <figure>
   <title>&hawk2; History Report&mdash;Transition Graph</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="hawk2-history-graph.png" width="80%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="hawk2-history-graph.png" width="70%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>

  <procedure xml:id="pro.hawk2.history.transitions">
   <title>Viewing Transition Details</title>
   <step>
    <para>Log in to &hawk2;:</para>
    <screen>https://<replaceable>HAWKSERVER</replaceable>:7630/</screen>
   </step>
   <step>
    <para> In the left navigation bar, select <guimenu>History</guimenu>.</para>
    <para>If reports have already been generated or uploaded, they are shown in
     the list of <guimenu>Reports</guimenu>. Otherwise generate or upload a report
     as described in <xref linkend="pro.hawk2.history.report"
     xrefstyle="select:label"/>.
    </para>
   </step>
   <step>
    <para>Click the report's name or select <guimenu>Show</guimenu> from the
     <guimenu>Operations</guimenu> column to view
     <xref linkend="il.hawk2.history.report.details" xrefstyle="select:title"/>.
    </para>
   </step>
   <step>
    <para>To access the transition details, you need to select a transition
     point in the transition time line that is shown below. Use the
      <guimenu>Previous</guimenu> and <guimenu>Next</guimenu> buttons and the
      <guimenu>Zoom In</guimenu> and <guimenu>Zoom Out</guimenu> icons to find
     the transition that you are interested in.</para></step>
    <step><para>Hover the mouse pointer over a transition point in the time line
     to display the name of the <filename>pe-input*</filename> file plus the time
     and node on which it was created.
   </para>
   </step>
   <step>
    <para>To view <xref linkend="vl.hawk2.history.transition.details"
    xrefstyle="select:title"/>, click the transition point for which you
    want to know the details.</para>
   </step>
   <step>
    <para>Click any of the buttons described in <xref
      linkend="vl.hawk2.history.transition.details" xrefstyle="select:label"/>
     to show the contents.</para>
   </step>
   <step>
    <para>To return to the list of reports, click the <guimenu>Reports</guimenu>
     button.</para>
   </step>
  </procedure>
 </sect2> 
</sect1>
 
 